<!DOCTYPE html>
<html lang="ro">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>MapThePast - Itinerar Cultural</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
<style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    min-height: 100vh;
    color: #333;
}

body[data-theme="dark"] {
    background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
    color: #fff;
}

header {
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    padding: 20px 40px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    position: sticky;
    top: 0;
    z-index: 100;
}

body[data-theme="dark"] header {
    background: rgba(26, 26, 46, 0.95);
}

.logo {
    font-size: 28px;
    font-weight: bold;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

.header-buttons {
    display: flex;
    gap: 10px;
}

.toggle-theme, #historyBtn {
    padding: 10px 20px;
    border: none;
    border-radius: 25px;
    cursor: pointer;
    font-size: 16px;
    transition: all 0.3s;
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
}

.toggle-theme {
    background: #667eea;
    color: white;
}

#historyBtn {
    background: #4CAF50;
    color: white;
}

.toggle-theme:hover, #historyBtn:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(0,0,0,0.3);
}

.auth-container {
    max-width: 450px;
    margin: 80px auto;
    background: white;
    padding: 40px;
    border-radius: 20px;
    box-shadow: 0 10px 40px rgba(0,0,0,0.2);
    animation: slideIn 0.5s ease-out;
}

@keyframes slideIn {
    from {
        opacity: 0;
        transform: translateY(-30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

body[data-theme="dark"] .auth-container {
    background: rgba(26, 26, 46, 0.9);
    color: white;
}

.auth-container h2 {
    text-align: center;
    margin-bottom: 30px;
    color: #667eea;
}

.auth-container input {
    width: 100%;
    padding: 15px;
    margin-bottom: 15px;
    border: 2px solid #e0e0e0;
    border-radius: 10px;
    font-size: 16px;
}

.auth-container input:focus {
    outline: none;
    border-color: #667eea;
}

.auth-container button {
    width: 100%;
    padding: 15px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border: none;
    border-radius: 10px;
    font-size: 18px;
    cursor: pointer;
}

.auth-container button:hover {
    transform: scale(1.05);
}

.app-container {
    max-width: 1400px;
    margin: 40px auto;
    padding: 0 20px;
}

.welcome-section {
    background: white;
    padding: 30px;
    border-radius: 20px;
    box-shadow: 0 10px 40px rgba(0,0,0,0.1);
    margin-bottom: 30px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

body[data-theme="dark"] .welcome-section {
    background: rgba(26, 26, 46, 0.9);
}

.welcome-section h2 {
    color: #667eea;
}

.welcome-section button {
    padding: 10px 20px;
    background: #ff5252;
    color: white;
    border: none;
    border-radius: 10px;
    cursor: pointer;
}

.main-content {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 30px;
    margin-bottom: 30px;
}

.control-panel {
    background: white;
    padding: 30px;
    border-radius: 20px;
    box-shadow: 0 10px 40px rgba(0,0,0,0.1);
}

body[data-theme="dark"] .control-panel {
    background: rgba(26, 26, 46, 0.9);
}

.control-panel label {
    display: block;
    margin-bottom: 10px;
    font-weight: bold;
    color: #667eea;
}

.control-panel select, .control-panel input {
    width: 100%;
    padding: 15px;
    margin-bottom: 20px;
    border: 2px solid #e0e0e0;
    border-radius: 10px;
    font-size: 16px;
}

.generate-btn {
    width: 100%;
    padding: 15px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border: none;
    border-radius: 10px;
    font-size: 18px;
    cursor: pointer;
}

#map {
    height: 500px;
    border-radius: 20px;
    overflow: hidden;
    box-shadow: 0 10px 40px rgba(0,0,0,0.1);
}

.day {
    background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
    padding: 20px;
    margin-bottom: 20px;
    border-radius: 15px;
    cursor: pointer;
    transition: all 0.3s;
    opacity: 0;
    transform: translateY(20px);
}

.day.show {
    opacity: 1;
    transform: translateY(0);
}

.day:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 30px rgba(0,0,0,0.2);
}

.day h3 {
    color: #667eea;
    margin-bottom: 15px;
}

.objectives {
    list-style: none;
}

.objectives li {
    padding: 10px;
    margin-bottom: 5px;
    background: white;
    border-radius: 8px;
}

.time {
    color: #764ba2;
    font-weight: bold;
    margin-right: 10px;
}

.restaurant-card {
    min-width: 280px;
    background: white;
    border-radius: 15px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    overflow: hidden;
    transition: all 0.3s;
    cursor: pointer;
}

.restaurant-card:hover {
    transform: translateY(-10px) scale(1.02);
    box-shadow: 0 15px 40px rgba(0,0,0,0.3);
}

.restaurant-img {
    width: 100%;
    height: 180px;
    object-fit: cover;
}

.restaurant-info {
    padding: 15px;
}

.restaurant-name {
    font-size: 18px;
    font-weight: bold;
    margin-bottom: 5px;
    color: #667eea;
}

.restaurant-cuisine {
    color: #666;
    font-size: 14px;
    margin-bottom: 10px;
}

.stars {
    color: #FFD700;
    font-size: 16px;
}

#restaurantsSection {
    background: white;
    padding: 30px;
    border-radius: 20px;
    box-shadow: 0 10px 40px rgba(0,0,0,0.1);
    margin-bottom: 30px;
}

body[data-theme="dark"] #restaurantsSection {
    background: rgba(26, 26, 46, 0.9);
}

#restaurantsSection h2 {
    color: #667eea;
    margin-bottom: 20px;
}

#restaurantsList {
    display: flex;
    overflow-x: auto;
    gap: 20px;
    padding: 20px 0;
}

.itinerary-section {
    background: white;
    padding: 30px;
    border-radius: 20px;
    box-shadow: 0 10px 40px rgba(0,0,0,0.1);
    margin-bottom: 30px;
}

body[data-theme="dark"] .itinerary-section {
    background: rgba(26, 26, 46, 0.9);
}

#rightMenu {
    position: fixed;
    top: 0;
    right: 0;
    width: 350px;
    height: 100%;
    background: white;
    box-shadow: -5px 0 20px rgba(0,0,0,0.3);
    padding: 30px;
    z-index: 999;
    overflow-y: auto;
    display: none;
}

body[data-theme="dark"] #rightMenu {
    background: rgba(26, 26, 46, 0.98);
}

#closeMenuBtn {
    float: right;
    background: #ff5252;
    color: white;
    border: none;
    padding: 8px 15px;
    border-radius: 8px;
    cursor: pointer;
}

#pastTripsList, #toDoList {
    list-style: none;
    padding: 0;
}

#toDoList li {
    padding: 12px;
    background: #fff3cd;
    margin-bottom: 8px;
    border-radius: 8px;
    display: flex;
    justify-content: space-between;
}

.faq-section {
    background: white;
    padding: 30px;
    border-radius: 20px;
    box-shadow: 0 10px 40px rgba(0,0,0,0.1);
}

.faq-question {
    width: 100%;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 15px;
    border: none;
    border-radius: 10px;
    cursor: pointer;
    margin-bottom: 10px;
}

.faq-answer {
    display: none;
    padding: 15px;
    background: #f5f7fa;
    border-radius: 10px;
    margin-bottom: 15px;
}
</style>
</head>
<body data-theme="light">

<header>
    <div class="logo">âœˆï¸ CulturalMap</div>
    <div class="header-buttons">
        <button class="toggle-theme" onclick="toggleTheme()">ğŸŒ™</button>
        <button id="historyBtn">ğŸ“‹ Trips</button>
    </div>
</header>

<div class="auth-container" id="auth-container">
    <div id="register-form">
        <h2>Ãnregistrare</h2>
        <input type="text" id="reg-username" placeholder="Username">
        <input type="password" id="reg-password" placeholder="Parola">
        <button onclick="register()">ÃnregistreazÄƒ-te</button>
        <p style="text-align:center; margin-top:15px;">Ai cont? <a href="#" onclick="showLogin()">Login</a></p>
        <p id="reg-msg" style="color:red;"></p>
    </div>

    <div id="login-form" style="display:none;">
        <h2>Login</h2>
        <input type="text" id="login-username" placeholder="Username">
        <input type="password" id="login-password" placeholder="Parola">
        <button onclick="login()">Login</button>
        <p style="text-align:center; margin-top:15px;">Nu ai cont? <a href="#" onclick="showRegister()">Ãnregistrare</a></p>
        <p id="login-msg" style="color:red;"></p>
    </div>
</div>

<div class="app-container" id="app-container" style="display:none;">
    <div class="welcome-section">
        <h2>Bun venit, <span id="user-name"></span>! ğŸ‘‹</h2>
        <button onclick="logout()">Logout</button>
    </div>

    <div class="main-content">
        <div class="control-panel">
            <h2 style="color:#667eea; margin-bottom:20px;">ğŸ“ PlanificÄƒ cÄƒlÄƒtoria</h2>
            <label for="city">OraÈ™</label>
            <select id="city">
                <option value="Paris">ğŸ‡«ğŸ‡· Paris</option>
                <option value="Madrid">ğŸ‡ªğŸ‡¸ Madrid</option>
                <option value="Tokyo">ğŸ‡¯ğŸ‡µ Tokyo</option>
                <option value="Rome">ğŸ‡®ğŸ‡¹ Rome</option>
                <option value="Milan">ğŸ‡®ğŸ‡¹ Milan</option>
                <option value="New York">ğŸ‡ºğŸ‡¸ New York</option>
                <option value="Amsterdam">ğŸ‡³ğŸ‡± Amsterdam</option>
                <option value="Sydney">ğŸ‡¦ğŸ‡º Sydney</option>
                <option value="Singapore">ğŸ‡¸ğŸ‡¬ Singapore</option>
                <option value="Barcelona">ğŸ‡ªğŸ‡¸ Barcelona</option>
                <option value="Bangkok">ğŸ‡¹ğŸ‡­ Bangkok</option>
                <option value="Istanbul">ğŸ‡¹ğŸ‡· Istanbul</option>
                <option value="London">ğŸ‡¬ğŸ‡§ London</option>
                <option value="Hong Kong">ğŸ‡­ğŸ‡° Hong Kong</option>
                <option value="Mecca">ğŸ‡¸ğŸ‡¦ Mecca</option>
                <option value="Dubai">ğŸ‡¦ğŸ‡ª Dubai</option>
                <option value="Macau">ğŸ‡²ğŸ‡´ Macau</option>
                <option value="Kuala Lumpur">ğŸ‡²ğŸ‡¾ Kuala Lumpur</option>
                <option value="Seoul">ğŸ‡°ğŸ‡· Seoul</option>
                <option value="Beijing">ğŸ‡¨ğŸ‡³ Beijing</option>
                <option value="Shanghai">ğŸ‡¨ğŸ‡³ Shanghai</option>
                <option value="Lisbon">ğŸ‡µğŸ‡¹ Lisbon</option>
                <option value="Prague">ğŸ‡¨ğŸ‡¿ Prague</option>
                <option value="Vienna">ğŸ‡¦ğŸ‡¹ Vienna</option>
                <option value="Venice">ğŸ‡®ğŸ‡¹ Venice</option>
                <option value="Los Angeles">ğŸ‡ºğŸ‡¸ Los Angeles</option>
                <option value="San Francisco">ğŸ‡ºğŸ‡¸ San Francisco</option>
                <option value="Mexico City">ğŸ‡²ğŸ‡½ Mexico City</option>
                <option value="Cairo">ğŸ‡ªğŸ‡¬ Cairo</option>
            </select>

            <label for="days">Zile</label>
            <input type="number" id="days" min="1" max="14" value="3" />
            <button class="generate-btn" onclick="generateItinerary()">ğŸš€ GenereazÄƒ</button>
        </div>

        <div id="map"></div>
    </div>

    <div id="restaurantsSection" style="display:none;">
        <h2>ğŸ½ï¸ Localuri din <span id="selectedCity"></span></h2>
        <div id="restaurantsList"></div>
    </div>

    <div class="itinerary-section">
        <div id="output"></div>
    </div>

    <div class="faq-section">
        <h2>â“ FAQ</h2>
        <button class="faq-question">Cum aleg zilele?</button>
        <div class="faq-answer">Depinde de timp È™i obiective.</div>
        <button class="faq-question">Pot adÄƒuga obiective?</button>
        <div class="faq-answer">Da, poÈ›i personaliza itinerariul.</div>
    </div>
</div>

<div id="rightMenu">
    <button id="closeMenuBtn">âœ•</button>
    <h2>My Trips</h2>
    <div style="margin:20px 0;">
        <h3>ğŸ“ Last Trips</h3>
        <ul id="pastTripsList"></ul>
        <button onclick="saveCurrentTrip()" style="width:100%; padding:10px; background:#2196F3; color:white; border:none; border-radius:8px; margin-top:10px; cursor:pointer;">ğŸ’¾ Save Trip</button>
    </div>
    <div>
        <h3>âœ… To-Do</h3>
        <div style="display:flex; gap:10px; margin:10px 0;">
            <input type="text" id="todoInput" placeholder="Task..." style="flex:1; padding:10px; border:2px solid #e0e0e0; border-radius:8px;">
            <button onclick="addTodo()" style="padding:10px 20px; background:#4CAF50; color:white; border:none; border-radius:8px; cursor:pointer;">+</button>
        </div>
        <ul id="toDoList"></ul>
    </div>
</div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
let map;

const restaurantsData = {
    "Paris": [
        { name: "Le Jules Verne", cuisine: "French", rating: 4.8, img: "https://images.unsplash.com/photo-1414235077428-338989a2e8c0?w=400" },
        { name: "L'Ami Jean", cuisine: "Bistro", rating: 4.7, img: "https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?w=400" },
        { name: "Septime", cuisine: "Contemporary", rating: 4.9, img: "https://images.unsplash.com/photo-1555396273-367ea4eb4db5?w=400" }
    ],
    "Rome": [
        { name: "La Pergola", cuisine: "Italian", rating: 4.9, img: "https://images.unsplash.com/photo-1515003197210-e0cd71810b5f?w=400" },
        { name: "Roscioli", cuisine: "Trattoria", rating: 4.7, img: "https://images.unsplash.com/photo-1555396273-367ea4eb4db5?w=400" }
    ],
    "Tokyo": [
        { name: "Sukiyabashi Jiro", cuisine: "Sushi", rating: 5.0, img: "https://images.unsplash.com/photo-1579584425555-c3ce17fd4351?w=400" },
        { name: "Narisawa", cuisine: "Japanese", rating: 4.9, img: "https://images.unsplash.com/photo-1555396273-367ea4eb4db5?w=400" }
    ],
    "Madrid": [
        { name: "DiverXO", cuisine: "Avant-garde", rating: 4.9, img: "https://images.unsplash.com/photo-1414235077428-338989a2e8c0?w=400" },
        { name: "BotÃ­n", cuisine: "Spanish", rating: 4.6, img: "https://images.unsplash.com/photo-1555396273-367ea4eb4db5?w=400" }
    ],
    "London": [
        { name: "The Ledbury", cuisine: "European", rating: 4.9, img: "https://images.unsplash.com/photo-1414235077428-338989a2e8c0?w=400" },
        { name: "Dishoom", cuisine: "Indian", rating: 4.7, img: "https://images.unsplash.com/photo-1555396273-367ea4eb4db5?w=400" }
    ],
    "New York": [
        { name: "Eleven Madison Park", cuisine: "American", rating: 4.9, img: "https://images.unsplash.com/photo-1414235077428-338989a2e8c0?w=400" },
        { name: "Le Bernardin", cuisine: "Seafood", rating: 4.9, img: "https://images.unsplash.com/photo-1555396273-367ea4eb4db5?w=400" }
    ]
};

function getUsers(){ return JSON.parse(localStorage.getItem('users')||'[]'); }
function saveUsers(users){ localStorage.setItem('users', JSON.stringify(users)); }

function register(){
    const u=document.getElementById('reg-username').value.trim();
    const p=document.getElementById('reg-password').value.trim();
    const msg=document.getElementById('reg-msg');
    if(!u||!p){ msg.textContent="CompleteazÄƒ toate!"; return; }
    let users=getUsers();
    if(users.find(x=>x.username===u)){ msg.textContent="Username existent!"; return; }
    users.push({username:u,password:p});
    saveUsers(users);
    msg.style.color='green';
    msg.textContent="Cont creat! LogheazÄƒ-te.";
}

function login(){
    const u=document.getElementById('login-username').value.trim();
    const p=document.getElementById('login-password').value.trim();
    const msg=document.getElementById('login-msg');
    let users=getUsers();
    let user=users.find(x=>x.username===u&&x.password===p);
    if(user){ localStorage.setItem('currentUser',u); showApp(); } 
    else{ msg.textContent="Date greÈ™ite!"; }
}

function logout(){ 
    localStorage.removeItem('currentUser'); 
    document.getElementById('app-container').style.display='none'; 
    document.getElementById('auth-container').style.display='block'; 
}

function showRegister(){ 
    document.getElementById('register-form').style.display='block'; 
    document.getElementById('login-form').style.display='none'; 
}

function showLogin(){ 
    document.getElementById('register-form').style.display='none'; 
    document.getElementById('login-form').style.display='block'; 
}

function showApp(){
    const u=localStorage.getItem('currentUser');
    if(!u)return;
    document.getElementById('user-name').textContent=u;
    document.getElementById('auth-container').style.display='none';
    document.getElementById('app-container').style.display='block';
    initWorldMap();
}

function generateItinerary(){
    const city=document.getElementById("city").value;
    const days=parseInt(document.getElementById("days").value);
    const out=document.getElementById("output");
    
    showRestaurants(city);
    
    fetch('data.json')
        .then(response => response.json())
        .then(data => {
            if(!data[city]){ 
                out.innerHTML='<p>Nu existÄƒ date pentru acest oraÈ™.</p>'; 
                return; 
            }
            
            let html=`<h2>Itinerariu pentru ${city}</h2>`;
            for(let i=1; i<=days; i++){
                const dayIndex=(i-1)%data[city].length;
                const dayActivities=data[city][dayIndex];
                html+=`<div class="day">
                    <h3>Ziua ${i}</h3>
                    <ul class="objectives">
                        ${dayActivities.map(a=>`<li><span class="time">${a.time}</span> ${a.activity}</li>`).join('')}
                    </ul>
                </div>`;
            }
            out.innerHTML=html;
            
            // AfiÈ™eazÄƒ harta pentru prima zi
            if(data[city][0] && data[city][0].length > 0){
                showMap(data[city][0]);
            }
            
            const daysEls = document.querySelectorAll('.day');
            daysEls.forEach((dayEl,index)=>{
                setTimeout(()=>{ dayEl.classList.add('show'); }, index*150);
                const dayIndex=(index)%data[city].length;
                dayEl.addEventListener('click',()=>{ 
                    showMap(data[city][dayIndex]); 
                });
            });
        })
        .catch(err => {
            console.error(err);
            out.innerHTML='<p>Eroare la Ã®ncÄƒrcarea datelor.</p>';
        });
}

function showMap(dayActivities){
    if(map) map.remove();
    
    const firstLat = dayActivities[0]?.lat || 48.8566;
    const firstLng = dayActivities[0]?.lng || 2.3522;
    
    map = L.map('map').setView([firstLat, firstLng], 13);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: 'Â© OpenStreetMap'
    }).addTo(map);
    
    dayActivities.forEach(act => {
        if(act.lat && act.lng){
            L.marker([act.lat, act.lng]).addTo(map).bindPopup(act.activity);
        }
    });
}

function showRestaurants(city) {
    const section = document.getElementById('restaurantsSection');
    const citySpan = document.getElementById('selectedCity');
    const list = document.getElementById('restaurantsList');
    
    citySpan.textContent = city;
    const restaurants = restaurantsData[city] || [];
    
    if (restaurants.length === 0) {
        section.style.display = 'none';
        return;
    }
    
    section.style.display = 'block';
    list.innerHTML = '';
    
    restaurants.forEach(rest => {
        const stars = 'â­'.repeat(Math.floor(rest.rating));
        const card = document.createElement('div');
        card.className = 'restaurant-card';
        card.innerHTML = `
            <img src="${rest.img}" class="restaurant-img" alt="${rest.name}">
            <div class="restaurant-info">
                <div class="restaurant-name">${rest.name}</div>
                <div class="restaurant-cuisine">${rest.cuisine}</div>
                <div><span class="stars">${stars}</span> ${rest.rating}</div>
            </div>
        `;
        list.appendChild(card);
    });
}

function initWorldMap() {
    if(map) map.remove();
    map = L.map('map').setView([20, 0], 2);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);
}

function toggleTheme(){
    const cur=document.body.getAttribute("data-theme");
    document.body.setAttribute("data-theme", cur==='dark'?'light':'dark');
}

const historyBtn = document.getElementById("historyBtn");
const rightMenu = document.getElementById("rightMenu");
const closeMenuBtn = document.getElementById("closeMenuBtn");

historyBtn.addEventListener("click", () => {
    rightMenu.style.display = rightMenu.style.display === 'block' ? 'none' : 'block';
});

closeMenuBtn.addEventListener("click", () => {
    rightMenu.style.display = 'none';
});

function saveCurrentTrip() {
    const city = document.getElementById("city").value;
    const days = document.getElementById("days").value;
    const list = document.getElementById("pastTripsList");
    const li = document.createElement("li");
    li.style.cssText = "padding:10px; background:#f0f0f0; margin:5px 0; border-radius:8px;";
    li.innerHTML = `<strong>${city}</strong> - ${days} zile<br><small>${new Date().toLocaleDateString()}</small>`;
    list.insertBefore(li, list.firstChild);
    alert(`Trip salvat: ${city}`);
}

function addTodo() {
    const input = document.getElementById("todoInput");
    const task = input.value.trim();
    if (!task) return;
    const list = document.getElementById("toDoList");
    const li = document.createElement("li");
    li.innerHTML = `<span><input type="checkbox"> ${task}</span>
        <button onclick="this.parentElement.remove()" style="background:#ff5252; color:white; border:none; padding:5px 10px; border-radius:5px; cursor:pointer;">ğŸ—‘ï¸</button>`;
    list.appendChild(li);
    input.value = "";
}

document.getElementById("todoInput")?.addEventListener("keypress", (e) => {
    if (e.key === "Enter") addTodo();
});

document.querySelectorAll('.faq-question').forEach(btn => {
    btn.addEventListener('click', () => {
        const answer = btn.nextElementSibling;
        answer.style.display = answer.style.display === 'block' ? 'none' : 'block';
    });
});

window.onload=()=>{
    const u=localStorage.getItem('currentUser');
    if(u) showApp();
};
</script>
</body>
</html>